function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cHmc:function(e,t,i){"use strict";i.r(t),i.d(t,"AdministrarVisitasPageModule",(function(){return k}));var n=i("ofXK"),a=i("3Pt+"),r=i("TEn/"),o=i("tyNb"),s=i("mrSG"),c=i("lENo"),l=i("fXoL"),u=i("89nv"),d=i("jCJ1");function f(e,t){if(1&e){var i=l.Pb();l.Ob(0,"ion-icon",26),l.Wb("click",(function(){l.gc(i);var e=l.Yb().$implicit;return l.Yb().eliminarVisitaAlert(e)})),l.Nb()}}function b(e,t){if(1&e){var i=l.Pb();l.Ob(0,"ion-icon",27),l.Wb("click",(function(){l.gc(i);var e=l.Yb().$implicit;return l.Yb().marcarEntregadoAlert(e)})),l.Nb()}}function h(e,t){if(1&e){var i=l.Pb();l.Ob(0,"ion-item",19),l.Ob(1,"ion-col",20),l.Wb("click",(function(){l.gc(i);var e=t.$implicit;return l.Yb().verVisita(e.id_visita)})),l.kc(2),l.Zb(3,"date"),l.Nb(),l.Ob(4,"ion-col",20),l.Wb("click",(function(){l.gc(i);var e=t.$implicit;return l.Yb().verVisita(e.id_visita)})),l.kc(5),l.Nb(),l.Ob(6,"ion-col",20),l.Wb("click",(function(){l.gc(i);var e=t.$implicit;return l.Yb().verVisita(e.id_visita)})),l.kc(7),l.Nb(),l.Ob(8,"ion-col",21),l.Ob(9,"ion-icon",22),l.Wb("click",(function(){l.gc(i);var e=t.$implicit;return l.Yb().verVisita(e.id_visita)})),l.Nb(),l.jc(10,f,1,0,"ion-icon",23),l.jc(11,b,1,0,"ion-icon",24),l.Nb(),l.Ob(12,"ion-col",25),l.Wb("click",(function(){l.gc(i);var e=t.$implicit;return l.Yb().verVisita(e.id_visita)})),l.Nb(),l.Nb()}if(2&e){var n=t.$implicit;l.zb(2),l.mc("",l.ac(3,5,n.fecha_visita,"dd/MM/yyyy HH:mm")," "),l.zb(3),l.lc(n.razon_social_sucursal),l.zb(2),l.lc(n.estado_visitas),l.zb(3),l.dc("ngIf","pendiente"==n.estado_visitas||"en proceso"==n.estado_visitas),l.zb(1),l.dc("ngIf","finalizada"==n.estado_visitas)}}function g(e,t){1&e&&(l.Ob(0,"ion-item"),l.Ob(1,"ion-label",28),l.kc(2,"No se encuentran visitas que cumplan las condiciones"),l.Nb(),l.Nb())}var v,m,p,_=[{path:"",component:(v=function(){function e(t,i,n,a,r,o,s){_classCallCheck(this,e),this.apiVisitasService=t,this.router=i,this.modalController=n,this.api_clientes=a,this.toastController=r,this.loadingController=o,this.alertController=s,this.visitas=[],this.entregado=!0,this.finalizada=!0,this.enProceso=!0,this.pendiente=!0,this.filtrar_fecha=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.filtroHoy(),this.getVisitas()}},{key:"getVisitas",value:function(){var e=this;this.apiVisitasService.getAllVisitas().then((function(t){console.log(t.result),e.visitas=t.result,e.filtrar()}))}},{key:"entreFechas",value:function(e){return console.log(new Date(new Date(this.fecha_desde).setHours(0)),"///////",new Date(new Date(e.fecha_visita).setDate(new Date(e.fecha_visita).getDate())),"////////////",new Date(new Date(this.fecha_desde).setHours(24))),new Date(e.fecha_visita).setDate(new Date(e.fecha_visita).getDate()).valueOf()>=new Date(this.fecha_desde).setHours(0).valueOf()&&new Date(e.fecha_visita).setDate(new Date(e.fecha_visita).getDate()).valueOf()<=new Date(this.fecha_hasta).setHours(24).valueOf()}},{key:"filtrar",value:function(){var e=this;this.filtrar_fecha?(this.visitas_filtro=this.visitas.filter((function(t){return e.revisarEstado(t)})),this.visitas_filtro.sort(this.ordenarVisitas)):(this.visitas_filtro=this.visitas.filter((function(t){return e.entreFechas(t)&&e.revisarEstado(t)})),this.visitas_filtro.sort(this.ordenarVisitas)),this.temp=this.visitas_filtro,this.updateFilter()}},{key:"ordenarVisitas",value:function(e,t){var i=new Date(e.fecha_visita).valueOf();return new Date(t.fecha_visita).valueOf()-i}},{key:"revisarEstado",value:function(e){return"entregado"==e.estado_visitas?this.entregado:"finalizada"==e.estado_visitas?this.finalizada:"en proceso"==e.estado_visitas?this.enProceso:"pendiente"==e.estado_visitas?this.pendiente:void 0}},{key:"revisarMenor",value:function(){new Date(this.fecha_desde).valueOf()>new Date(this.fecha_hasta).valueOf()&&(this.fecha_hasta=this.fecha_desde),this.filtrar()}},{key:"revisarMayor",value:function(){new Date(this.fecha_desde).valueOf()>new Date(this.fecha_hasta).valueOf()&&(this.fecha_desde=this.fecha_hasta),this.filtrar()}},{key:"navigateToCrearVisita",value:function(){this.router.navigateByUrl("menu-principal/programar-visita")}},{key:"verVisita",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:c.a,cssClass:"my-custom-class",componentProps:{id_visita:e}});case 2:return i=t.sent,t.next=5,i.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"eliminarVisitaAlert",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Seguro que desea eliminar la visita?",buttons:[{text:"No",handler:function(){}},{text:"Si",handler:function(){i.eliminarVisita(e)}}]});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"eliminarVisita",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadingController.create({message:"Eliminando la visita"});case 2:(i=t.sent).present(),this.api_clientes.cambiar_estado_visita(e.id_visita,"eliminado").then((function(e){i.dismiss(),n.getVisitas(),n.toastController.create({message:"Se elimino correctamente",duration:2e3,color:"success"}).then((function(e){e.present()})),console.log(e)})).catch((function(e){i.dismiss(),n.toastController.create({message:"Hubo un error al eliminar",duration:2e3,color:"danger"}).then((function(e){e.present()})),console.error(e)}));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"marcarEntregadoAlert",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Atenci\xf3n",message:"\xbfEstas seguro que deseas marcar esta visita como entregada?",buttons:[{text:"No",role:"cancel"},{text:"Si",handler:function(){n.marcarEntregado(e.id_visita)}}]});case 2:return i=t.sent,t.next=5,i.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"marcarEntregado",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadingController.create({message:"Cargando visita"});case 2:(i=t.sent).present(),this.api_clientes.cambiar_estado_visita(e,"entregado").then((function(e){n.getVisitas(),i.dismiss(),n.toastController.create({message:"Se Marco como entregada",duration:2e3,color:"success"}).then((function(e){e.present()}))})).catch((function(e){i.dismiss(),n.toastController.create({message:"Hubo un error al marcar como entregada",duration:2e3,color:"danger"}).then((function(e){e.present()})),console.error(e)}));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"filtroHoy",value:function(){var e=(new Date).getFullYear().toString()+"-"+((new Date).getMonth()+1>=10?((new Date).getMonth()+1).toString():"0"+((new Date).getMonth()+1).toString())+"-"+((new Date).getDate()>=10?(new Date).getDate():"0"+(new Date).getDate().toString())+"T00:00:00-03:00";this.fecha_hasta=e,this.fecha_desde=e,console.log("filtroHoy",e),this.filtrar_fecha=!1}},{key:"sumarDia",value:function(e){return console.log(new Date(e).setDate(e.getDate()+1)),new Date(e).setDate(e.getDate()+1)}},{key:"hoyDisable",value:function(){var e=(new Date).getFullYear().toString()+"-"+((new Date).getMonth()+1).toString()+"-"+(new Date).getDate().toString()+"T00:00:00-03:00";return e==this.fecha_hasta&&e==this.fecha_desde&&!this.filtrar_fecha}},{key:"updateFilter",value:function(e){if(e){var t=e.target.value.toLowerCase(),i=this.temp.filter((function(e){var i,n;return(null===(i=e.razon_social_cliente)||void 0===i?void 0:i.toLowerCase().includes(t))||(null===(n=e.razon_social_sucursal)||void 0===n?void 0:n.toLowerCase().includes(t))}));this.visitas_filtro=i}else{var n=this.busqueda,a=this.temp.filter((function(e){var t,i;return(null===(t=e.razon_social_cliente)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(i=e.razon_social_sucursal)||void 0===i?void 0:i.toLowerCase().includes(n))}));n&&(this.visitas_filtro=a)}}},{key:"searchClear",value:function(){this.visitas_filtro=this.temp}}]),e}(),v.\u0275fac=function(e){return new(e||v)(l.Jb(u.a),l.Jb(o.f),l.Jb(r.I),l.Jb(d.a),l.Jb(r.Q),l.Jb(r.H),l.Jb(r.a))},v.\u0275cmp=l.Db({type:v,selectors:[["app-administrar-visitas"]],decls:56,vars:13,consts:[["size","1"],["shape","round",3,"disabled","click"],["size","2"],["lines","none"],["position","floating"],["display-format","DD.MM.YYYY",3,"disabled","ngModel","ngModelChange","ionChange"],["size","2",1,"filter-col"],[1,"ion-text-wrap",2,"padding-right","5px"],[3,"ngModel","ngModelChange","ionChange"],["offset","0.6","size","1.1",1,"filter-col"],["size","1.1",1,"filter-col"],["animated","","placeholder","Sucursal || Razon Social",1,"ion-no-padding",2,"--background","rgb(250, 250, 250)",3,"ngModel","ngModelChange","ionClear","keyup"],["lines","full"],["size","3"],["class","itemHover",4,"ngFor","ngForOf"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",2,"padding-right","20px","padding-bottom","10px"],[3,"click"],["name","add"],[1,"itemHover"],["size","3",3,"click"],["size","0.8"],["color","primary","name","enter-outline",3,"click"],["color","danger","name","trash-outline",3,"click",4,"ngIf"],["style","padding-left: 5px;","name","mail-outline",3,"click",4,"ngIf"],["size","2.2",3,"click"],["color","danger","name","trash-outline",3,"click"],["name","mail-outline",2,"padding-left","5px",3,"click"],[2,"text-align","center"]],template:function(e,t){1&e&&(l.Ob(0,"ion-header"),l.Ob(1,"ion-toolbar"),l.Ob(2,"ion-item"),l.Ob(3,"ion-col",0),l.Ob(4,"ion-button",1),l.Wb("click",(function(){return t.filtroHoy()})),l.kc(5," Hoy "),l.Nb(),l.Nb(),l.Ob(6,"ion-col",2),l.Ob(7,"ion-item",3),l.Ob(8,"ion-label",4),l.kc(9,"Desde"),l.Nb(),l.Ob(10,"ion-datetime",5),l.Wb("ngModelChange",(function(e){return t.fecha_desde=e}))("ionChange",(function(){return t.revisarMenor()})),l.Nb(),l.Nb(),l.Nb(),l.Ob(11,"ion-col",2),l.Ob(12,"ion-item",3),l.Ob(13,"ion-label",4),l.kc(14,"Hasta"),l.Nb(),l.Ob(15,"ion-datetime",5),l.Wb("ngModelChange",(function(e){return t.fecha_hasta=e}))("ionChange",(function(){return t.revisarMayor()})),l.Nb(),l.Nb(),l.Nb(),l.Ob(16,"ion-col",6),l.Ob(17,"ion-label",7),l.kc(18,"Siempre"),l.Nb(),l.Ob(19,"ion-checkbox",8),l.Wb("ngModelChange",(function(e){return t.filtrar_fecha=e}))("ionChange",(function(){return t.filtrar()})),l.Nb(),l.Nb(),l.Ob(20,"ion-col",9),l.Ob(21,"ion-label",7),l.kc(22,"Entregado"),l.Nb(),l.Ob(23,"ion-checkbox",8),l.Wb("ngModelChange",(function(e){return t.entregado=e}))("ionChange",(function(){return t.filtrar()})),l.Nb(),l.Nb(),l.Ob(24,"ion-col",10),l.Ob(25,"ion-label",7),l.kc(26,"Finalizada"),l.Nb(),l.Ob(27,"ion-checkbox",8),l.Wb("ngModelChange",(function(e){return t.finalizada=e}))("ionChange",(function(){return t.filtrar()})),l.Nb(),l.Nb(),l.Ob(28,"ion-col",10),l.Ob(29,"ion-label",7),l.kc(30,"En proceso"),l.Nb(),l.Ob(31,"ion-checkbox",8),l.Wb("ngModelChange",(function(e){return t.enProceso=e}))("ionChange",(function(){return t.filtrar()})),l.Nb(),l.Nb(),l.Ob(32,"ion-col",10),l.Ob(33,"ion-label",7),l.kc(34,"Pendiente"),l.Nb(),l.Ob(35,"ion-checkbox",8),l.Wb("ngModelChange",(function(e){return t.pendiente=e}))("ionChange",(function(){return t.filtrar()})),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(36,"ion-content"),l.Ob(37,"ion-searchbar",11),l.Wb("ngModelChange",(function(e){return t.busqueda=e}))("ionClear",(function(){return t.searchClear()}))("keyup",(function(e){return t.updateFilter(e)})),l.Nb(),l.Ob(38,"ion-item",12),l.Ob(39,"ion-col",13),l.Ob(40,"b"),l.kc(41,"Fecha"),l.Nb(),l.Nb(),l.Ob(42,"ion-col",13),l.Ob(43,"b"),l.kc(44,"Sucursal"),l.Nb(),l.Nb(),l.Ob(45,"ion-col",13),l.Ob(46,"b"),l.kc(47,"Estado"),l.Nb(),l.Nb(),l.Ob(48,"ion-col",13),l.Ob(49,"b"),l.kc(50,"Acciones"),l.Nb(),l.Nb(),l.Nb(),l.jc(51,h,13,8,"ion-item",14),l.jc(52,g,3,0,"ion-item",15),l.Ob(53,"ion-fab",16),l.Ob(54,"ion-fab-button",17),l.Wb("click",(function(){return t.navigateToCrearVisita()})),l.Kb(55,"ion-icon",18),l.Nb(),l.Nb(),l.Nb()),2&e&&(l.zb(4),l.dc("disabled",t.hoyDisable()),l.zb(6),l.dc("disabled",t.filtrar_fecha)("ngModel",t.fecha_desde),l.zb(5),l.dc("disabled",t.filtrar_fecha)("ngModel",t.fecha_hasta),l.zb(4),l.dc("ngModel",t.filtrar_fecha),l.zb(4),l.dc("ngModel",t.entregado),l.zb(4),l.dc("ngModel",t.finalizada),l.zb(4),l.dc("ngModel",t.enProceso),l.zb(4),l.dc("ngModel",t.pendiente),l.zb(2),l.dc("ngModel",t.busqueda),l.zb(14),l.dc("ngForOf",t.visitas_filtro),l.zb(1),l.dc("ngIf",0==(null==t.visitas_filtro?null:t.visitas_filtro.length)))},directives:[r.q,r.F,r.t,r.j,r.d,r.u,r.l,r.O,a.d,a.e,r.i,r.b,r.k,r.x,r.P,n.i,n.j,r.m,r.n,r.r],pipes:[n.d],styles:[".filter-col[_ngcontent-%COMP%]{display:flex;align-items:center}ion-checkbox[_ngcontent-%COMP%]{min-width:18px}ion-icon[_ngcontent-%COMP%]{cursor:pointer}.no-pointer[_ngcontent-%COMP%]{cursor:default;color:grey}.itemHover[_ngcontent-%COMP%]:hover{--background:#ececec;cursor:pointer}"]}),v)}],O=((p=function e(){_classCallCheck(this,e)}).\u0275mod=l.Hb({type:p}),p.\u0275inj=l.Gb({factory:function(e){return new(e||p)},imports:[[o.h.forChild(_)],o.h]}),p),k=((m=function e(){_classCallCheck(this,e)}).\u0275mod=l.Hb({type:m}),m.\u0275inj=l.Gb({factory:function(e){return new(e||m)},imports:[[n.b,a.a,r.G,O]]}),m)}}]);