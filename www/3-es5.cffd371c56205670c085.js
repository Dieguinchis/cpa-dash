function _createForOfIteratorHelper(i,e){var t;if("undefined"==typeof Symbol||null==i[Symbol.iterator]){if(Array.isArray(i)||(t=_unsupportedIterableToArray(i))||e&&i&&"number"==typeof i.length){t&&(i=t);var o=0,s=function(){};return{s:s,n:function(){return o>=i.length?{done:!0}:{done:!1,value:i[o++]}},e:function(i){throw i},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,n=!0,a=!1;return{s:function(){t=i[Symbol.iterator]()},n:function(){var i=t.next();return n=i.done,i},e:function(i){a=!0,r=i},f:function(){try{n||null==t.return||t.return()}finally{if(a)throw r}}}}function _unsupportedIterableToArray(i,e){if(i){if("string"==typeof i)return _arrayLikeToArray(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);return"Object"===t&&i.constructor&&(t=i.constructor.name),"Map"===t||"Set"===t?Array.from(i):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(i,e):void 0}}function _arrayLikeToArray(i,e){(null==e||e>i.length)&&(e=i.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=i[t];return o}function _classCallCheck(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(i,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}function _createClass(i,e,t){return e&&_defineProperties(i.prototype,e),t&&_defineProperties(i,t),i}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+1S5":function(i,e,t){"use strict";t.d(e,"a",(function(){return n}));var o=t("tk/3"),s=t("octk"),r=t("fXoL"),n=function(){var i=function(){function i(e){_classCallCheck(this,i),this.http=e,this.apiDir="http://157.230.90.222:3001",this.requestOptions={headers:new o.c({"Content-Type":"application/json",version:s.a})}}return _createClass(i,[{key:"crear_servicio",value:function(i){return console.log(i),this.http.post(this.apiDir+"/servicios/crear",i,this.requestOptions)}},{key:"mostrar_servicios",value:function(){return this.http.get(this.apiDir+"/servicios",this.requestOptions)}},{key:"getZpl",value:function(i){return this.http.post(this.apiDir+"/servicios/imprimir",i,this.requestOptions)}},{key:"alta_producto",value:function(i){return this.http.post(this.apiDir+"/productos/crear",i,this.requestOptions)}},{key:"alta_workstation",value:function(i){return this.http.post(this.apiDir+"/servicios/equipos/crear",i,this.requestOptions)}},{key:"alta_Grupo_workstation",value:function(i){return this.http.post(this.apiDir+"/servicios/gruposEquipos/crear",i,this.requestOptions)}},{key:"eliminar_Grupo_workstation",value:function(i){return console.log("delete2",i),this.http.post(this.apiDir+"/servicios/eliminarGrupoEquipos/"+i,null,this.requestOptions)}},{key:"modificar_Grupo_workstation",value:function(i){return this.http.post(this.apiDir+"/servicios/gruposEquipos/crear",i,this.requestOptions)}},{key:"ver_servicio",value:function(i){return this.http.get(this.apiDir+"/servicios/id/"+i,this.requestOptions)}},{key:"baja_producto",value:function(i){return this.http.post(this.apiDir+"/productos/eliminar/"+i,null,this.requestOptions)}},{key:"baja_servicio",value:function(i){return this.http.post(this.apiDir+"/servicios/eliminar/"+i,null,this.requestOptions)}},{key:"update_servicio",value:function(i){return this.http.post(this.apiDir+"/servicios/update",i,this.requestOptions)}},{key:"baja_opcion",value:function(i){return this.http.post(this.apiDir+"/servicios/opcion/delete/",{id:i},this.requestOptions)}},{key:"ver_opciones_producto",value:function(i){return console.log(i),this.http.get(this.apiDir+"/servicios/producto/opciones/"+i,this.requestOptions)}},{key:"producto_update",value:function(i){return console.log(i),this.http.post(this.apiDir+"/productos/actualizar",i,this.requestOptions)}},{key:"getProductos",value:function(){return this.http.get(this.apiDir+"/productos/",this.requestOptions)}}]),i}();return i.\u0275fac=function(e){return new(e||i)(r.Sb(o.a))},i.\u0275prov=r.Fb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}()},OAWW:function(i,e,t){"use strict";t.d(e,"a",(function(){return O}));var o=t("mrSG"),s=t("wd/R"),r=t("fXoL"),n=t("89nv"),a=t("u//c"),c=t("jCJ1"),u=t("TEn/"),l=t("3Pt+"),p=t("ofXK");function v(i,e){if(1&i&&(r.Ob(0,"ion-select-option",13),r.kc(1),r.Nb()),2&i){var t=e.$implicit;r.ec("value",t.id_servicio),r.zb(1),r.lc(t.nombre_servicio)}}function d(i,e){if(1&i&&(r.Ob(0,"ion-select-option",13),r.kc(1),r.Nb()),2&i){var t=e.$implicit;r.ec("value",t.id_tecnico),r.zb(1),r.nc("",t.nombre_tecnico," ",t.apellido_tecnico,"")}}function b(i,e){if(1&i){var t=r.Pb();r.Ob(0,"div"),r.Ob(1,"ion-label",16),r.kc(2),r.Nb(),r.Ob(3,"ion-item",17),r.Ob(4,"ion-label",4),r.kc(5,"Seleccionar t\xe9cnico a cargo"),r.Nb(),r.Ob(6,"ion-select",18),r.Wb("ngModelChange",(function(i){return r.gc(t),e.$implicit.tecnico=i})),r.jc(7,d,2,3,"ion-select-option",6),r.Nb(),r.Nb(),r.Nb()}if(2&i){var o=e.$implicit,s=r.Yb(2);r.zb(2),r.lc(o.nombre_equipo),r.zb(4),r.dc("ngModel",o.tecnico),r.zb(1),r.dc("ngForOf",s.listado_tecnicos)}}function f(i,e){if(1&i&&(r.Ob(0,"div",14),r.Ob(1,"h2",14),r.kc(2),r.Nb(),r.jc(3,b,8,3,"div",15),r.Nb()),2&i){var t=e.$implicit;r.zb(2),r.lc(t.nombre_servicio),r.zb(1),r.dc("ngForOf",t.equipos)}}function h(i,e){if(1&i&&(r.Ob(0,"div"),r.Ob(1,"ion-label",16),r.kc(2),r.Nb(),r.Nb()),2&i){var t=e.$implicit;r.zb(2),r.nc("",t.nombre_equipo,": ",t.nombre_servicio,"")}}function _(i,e){if(1&i&&(r.Ob(0,"ion-select-option",13),r.kc(1),r.Nb()),2&i){var t=e.$implicit;r.ec("value",t.id_tecnico),r.zb(1),r.nc("",t.nombre_tecnico," ",t.apellido_tecnico,"")}}function m(i,e){if(1&i){var t=r.Pb();r.Ob(0,"div",14),r.Ob(1,"h2",14),r.kc(2),r.Nb(),r.jc(3,h,3,2,"div",15),r.Ob(4,"ion-item",17),r.Ob(5,"ion-label",4),r.kc(6,"Seleccionar t\xe9cnico a cargo"),r.Nb(),r.Ob(7,"ion-select",18),r.Wb("ngModelChange",(function(i){return r.gc(t),e.$implicit.tecnico=i})),r.jc(8,_,2,3,"ion-select-option",6),r.Nb(),r.Nb(),r.Nb()}if(2&i){var o=e.$implicit,s=r.Yb(2);r.zb(2),r.lc(o.nombre_equipo_grupo),r.zb(1),r.dc("ngForOf",o.equipos),r.zb(4),r.dc("ngModel",o.tecnico),r.zb(1),r.dc("ngForOf",s.listado_tecnicos)}}function g(i,e){if(1&i&&(r.Ob(0,"div"),r.jc(1,m,9,4,"div",7),r.Nb()),2&i){var t=r.Yb();r.zb(1),r.dc("ngForOf",t.grupoWorkStationElegidos)}}var O=function(){var i=function(){function i(e,t,o,s,r,n){_classCallCheck(this,i),this.api=e,this.api_tecnicos=t,this.api_clientes=o,this.navParams=s,this.ModalController=r,this.api_visitas=n,this.serviciosConEquipos=[],this.serviciosElegidos=[],this.serviciosParaEnviar=[],this.grupoWorkStation=[],this.grupoWorkStationElegidos=[],this.show=!1,this.id_visita=this.navParams.get("id_visita"),this.servicios_elegidosAux=[],this.id_cliente_elegido=null,this.sucursal_elegida=null,this.dayNames=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],this.monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}return _createClass(i,[{key:"ngOnInit",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var e=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.api.mostrar_servicios().subscribe((function(i){e.listado_servicios=i,e.listado_servicios=e.listado_servicios.result,console.log(e.listado_servicios,"servicios"),e.actualizar_informacion().then((function(i){console.warn(e.sucursal_elegida),e.api.listado_equipos(e.sucursal_elegida).subscribe((function(i){e.equipos=i.result,console.log(e.equipos,"equipos");var t,o=_createForOfIteratorHelper(e.listado_servicios);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.equipos=[];var r,n=_createForOfIteratorHelper(e.equipos);try{for(n.s();!(r=n.n()).done;){var a=r.value;a.id_servicio==s.id_servicio&&s.equipos.push(a)}}catch(c){n.e(c)}finally{n.f()}s.equipos.length<1&&s.equipos.push({id_equipo:0,id_servicio:s.id_servicio,nombre_equipo:"Servicio principal"})}}catch(c){o.e(c)}finally{o.f()}console.log(e.listado_servicios,"servicios completos")}))}))}));case 2:this.api_tecnicos.listado_tecnicos().subscribe((function(i){e.listado_tecnicos=i,e.listado_tecnicos=e.listado_tecnicos.result,console.log(e.listado_tecnicos)}),(function(i){console.log(i)})),this.fecha_actual=s().format();case 4:case"end":return i.stop()}}),i,this)})))}},{key:"actualizar_informacion",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var e=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.api_clientes.informacion_visita(this.id_visita).then((function(i){return e.visita=i,e.visita=e.visita.result,e.id_cliente_elegido=e.visita.visitas.id_cliente,e.sucursal_elegida=e.visita.visitas.id_sucursal,e.sucursalesCliente(e.id_cliente_elegido),e.visita.visitas.id_sucursal}));case 2:case"end":return i.stop()}}),i,this)})))}},{key:"sucursalesCliente",value:function(i){var e=this;this.api.informacion_cliente(i).subscribe((function(t){e.listado_sucursales_cliente=t,console.log(t),e.listado_sucursales_cliente=e.listado_sucursales_cliente.result.sucursales.datosSucursal,e.id_cliente_elegido=i,e.selectSucursal(),console.log(e.listado_sucursales_cliente)}))}},{key:"selectSucursal",value:function(){var i=this;this.api.listado_grupoWorkstations(this.sucursal_elegida).subscribe((function(e){var t=0,o=[],s=0,r=!0;e.result.forEach((function(i){i.id_equipo_grupo==t?o[s].equipos.push({id_equipo:i.id_equipo,id_servicio:i.id_servicio,id_sucursal:i.id_sucursal,nombre_equipo:i.nombre_equipo,codigo_qr_equipo:i.codigo_qr_equipo,estado_servicio:i.estado_servicio,nombre_servicio:i.nombre_servicio,qr:i.qr}):(r||s++,t=i.id_equipo_grupo,o.push({nombre_equipo_grupo:i.nombre_equipo_grupo,id_equipo_grupo:i.id_equipo_grupo,equipos:[]}),o[s].equipos.push({id_equipo:i.id_equipo,id_servicio:i.id_servicio,id_sucursal:i.id_sucursal,nombre_equipo:i.nombre_equipo,codigo_qr_equipo:i.codigo_qr_equipo,estado_servicio:i.estado_servicio,nombre_servicio:i.nombre_servicio,qr:i.qr}),r=!1)})),i.grupoWorkStation=o}))}},{key:"programarVisita",value:function(){var i,e=_createForOfIteratorHelper(this.serviciosElegidos);try{for(e.s();!(i=e.n()).done;){var t,o=i.value,s=_createForOfIteratorHelper(o.equipos);try{for(s.s();!(t=s.n()).done;){var r=t.value;this.serviciosParaEnviar.push({id_servicio:o.id_servicio,id_tecnico:r.tecnico,id_equipo:r.id_equipo})}}catch(v){s.e(v)}finally{s.f()}}}catch(v){e.e(v)}finally{e.f()}var n,a=_createForOfIteratorHelper(this.grupoWorkStationElegidos);try{for(a.s();!(n=a.n()).done;){var c,u=n.value,l=_createForOfIteratorHelper(u.equipos);try{for(l.s();!(c=l.n()).done;){var p=c.value;this.serviciosParaEnviar.push({id_servicio:p.id_servicio,id_tecnico:u.tecnico,id_equipo:p.id_equipo})}}catch(v){l.e(v)}finally{l.f()}}}catch(v){a.e(v)}finally{a.f()}console.log(this.serviciosParaEnviar),this.api_visitas.modificar_visita({id_cliente:this.id_cliente_elegido,id_sucursal:this.sucursal_elegida,servicios:this.serviciosParaEnviar,fecha_visita:this.fecha_elegida,id:this.visita.visitas.id_visita}).subscribe((function(i){console.log(i),location.reload()}))}},{key:"serviciosElegidosChange",value:function(){var i=this;this.serviciosElegidos=[];var e,t=_createForOfIteratorHelper(this.servicios_elegidosAux);try{for(t.s();!(e=t.n()).done;){var o,s=e.value,r=_createForOfIteratorHelper(this.listado_servicios);try{for(r.s();!(o=r.n()).done;){var n=o.value;n.id_servicio==s&&0==n.qr&&this.serviciosElegidos.push(n)}}catch(l){r.e(l)}finally{r.f()}}}catch(l){t.e(l)}finally{t.f()}var a=[{nombre_equipo_grupo:null,id_equipo_grupo:null,tecnico:null,equipos:[]}],c=0,u=!0;console.log(this.servicios_elegidosAux),this.grupoWorkStation.forEach((function(e){e.equipos.forEach((function(t){var o=t.id_servicio.toString();i.servicios_elegidosAux.includes(o)&&(i.checkExist(a,e.nombre_equipo_grupo)||null==a[0].nombre_equipo_grupo?u?(u=!1,a=[{nombre_equipo_grupo:e.nombre_equipo_grupo,id_equipo_grupo:e.id_equipo_grupo,tecnico:null,equipos:[t]}]):(console.log("1"),c+=1,u=!1,a.push({nombre_equipo_grupo:e.nombre_equipo_grupo,id_equipo_grupo:e.id_equipo_grupo,tecnico:null,equipos:[t]})):(console.log("3"),a[c].equipos.push(t)))}))})),this.grupoWorkStationElegidos=a,this.show=!0,null==this.grupoWorkStationElegidos[0].nombre_equipo_grupo&&(this.show=!1),console.log("Servicio elegidos: ",a)}},{key:"checkExist",value:function(i,e){return null==i.find((function(i){return i.nombre_equipo_grupo==e}))}},{key:"close",value:function(){this.ModalController.dismiss()}}]),i}();return i.\u0275fac=function(e){return new(e||i)(r.Jb(n.a),r.Jb(a.a),r.Jb(c.a),r.Jb(u.I),r.Jb(u.G),r.Jb(n.a))},i.\u0275cmp=r.Db({type:i,selectors:[["app-modificar-visita"]],decls:24,vars:12,consts:[["color","primary"],["slot","end"],[3,"click"],["name","close-outline"],["fixed","",2,"text-align","center"],["multiple","true",3,"disabled","ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["style","text-align: center;",4,"ngFor","ngForOf"],[4,"ngIf"],["displayFormat","DDDD D MMMM YYYY HH:mm","max","2022",3,"ngModel","doneText","cancelText","monthNames","dayNames","min","value","ngModelChange"],[2,"width","100%","text-align","center"],[2,"margin-top","25px"],["src","../../../assets/LogoCPA-01.png",1,"imagen_empresa"],[3,"value"],[2,"text-align","center"],[4,"ngFor","ngForOf"],["fixed","",2,"text-align","center","color","var(--ion-color-secondary)","font-weight","bold"],[2,"margin-top","10px"],[3,"ngModel","ngModelChange"]],template:function(i,e){1&i&&(r.Ob(0,"ion-header"),r.Ob(1,"ion-toolbar",0),r.Ob(2,"ion-title"),r.kc(3,"Modificar Visita"),r.Nb(),r.Ob(4,"ion-buttons",1),r.Ob(5,"ion-button",2),r.Wb("click",(function(){return e.close()})),r.Kb(6,"ion-icon",3),r.Nb(),r.Nb(),r.Nb(),r.Nb(),r.Ob(7,"ion-content"),r.Ob(8,"ion-item"),r.Ob(9,"ion-label",4),r.kc(10,"Seleccionar servicios a ofrecer"),r.Nb(),r.Ob(11,"ion-select",5),r.Wb("ngModelChange",(function(i){return e.servicios_elegidosAux=i}))("ionChange",(function(){return e.serviciosElegidosChange()})),r.jc(12,v,2,2,"ion-select-option",6),r.Nb(),r.Nb(),r.jc(13,f,4,2,"div",7),r.jc(14,g,2,1,"div",8),r.Ob(15,"ion-item"),r.Ob(16,"ion-label",4),r.kc(17,"Elegir una fecha"),r.Nb(),r.Ob(18,"ion-datetime",9),r.Wb("ngModelChange",(function(i){return e.fecha_elegida=i})),r.Nb(),r.Nb(),r.Ob(19,"div",10),r.Ob(20,"ion-button",2),r.Wb("click",(function(){return e.programarVisita()})),r.kc(21,"Modificar"),r.Nb(),r.Nb(),r.Ob(22,"div",11),r.Kb(23,"img",12),r.Nb(),r.Nb()),2&i&&(r.zb(11),r.dc("disabled",null==e.sucursal_elegida)("ngModel",e.servicios_elegidosAux),r.zb(1),r.dc("ngForOf",e.listado_servicios),r.zb(1),r.dc("ngForOf",e.serviciosElegidos),r.zb(1),r.dc("ngIf",e.show),r.zb(4),r.ec("min",e.fecha_actual),r.ec("value",e.fecha_actual),r.dc("ngModel",e.fecha_elegida)("doneText","Listo")("cancelText","Cancelar")("monthNames",e.monthNames)("dayNames",e.dayNames))},directives:[u.o,u.D,u.C,u.e,u.d,u.p,u.i,u.r,u.s,u.w,u.M,l.d,l.e,p.i,p.j,u.j,u.x],styles:[""]}),i}()},jCJ1:function(i,e,t){"use strict";t.d(e,"a",(function(){return a}));var o=t("mrSG"),s=t("tk/3"),r=t("octk"),n=t("fXoL"),a=function(){var i=function(){function i(e){_classCallCheck(this,i),this.http=e,this.apiDir="http://157.230.90.222:3001",this.requestOptions={headers:new s.c({"Content-Type":"application/json",version:r.a})}}return _createClass(i,[{key:"listado_clientes",value:function(){return this.http.get(this.apiDir+"/clientes",this.requestOptions)}},{key:"informacion_cliente",value:function(i){return this.http.get(this.apiDir+"/clientes/id/"+i,this.requestOptions)}},{key:"alta_sucursal",value:function(i){return this.http.post(this.apiDir+"/sucursales/crear",i,this.requestOptions)}},{key:"informacion_sucursal",value:function(i){return this.http.get(this.apiDir+"/sucursales/id/"+i,this.requestOptions)}},{key:"informacion_visita",value:function(i){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(this.apiDir+"/visitas/id/"+i,this.requestOptions);case 2:return e.abrupt("return",e.sent.toPromise());case 3:case"end":return e.stop()}}),e,this)})))}},{key:"listado_workstations",value:function(i){return this.http.get(this.apiDir+"/servicios/equipos/sucursal/"+i,this.requestOptions)}},{key:"listado_grupoWorkstations",value:function(i){return this.http.get(this.apiDir+"/servicios/gruposEquipos/sucursal/"+i,this.requestOptions)}},{key:"borrar_equipo",value:function(i){return this.http.post(this.apiDir+"/servicios/eliminarEquipos/"+i,null,this.requestOptions)}},{key:"listado_productosServicio",value:function(i){return this.http.get(this.apiDir+"/productos/idServicio/"+i,this.requestOptions)}},{key:"cambiar_estado_visita",value:function(i,e){var t=this;console.log(this.apiDir+"/visitas/cambiarEstado",this.requestOptions);var o={id_visita:i,estado:e};return new Promise((function(i,e){t.http.post(t.apiDir+"/visitas/cambiarEstado",o,t.requestOptions).subscribe((function(e){i(e)}),(function(i){e(i)}))}))}},{key:"eliminar_Grupo_workstation",value:function(i){return console.log("delete2",i),this.http.post(this.apiDir+"/servicios/eliminarGrupoEquipos/"+i,this.requestOptions)}},{key:"subir_planos",value:function(i){return this.http.post(this.apiDir+"/planos/crear",i,this.requestOptions)}},{key:"upload",value:function(i){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o,s){e.http.post(e.apiDir+i,t).subscribe((function(i){o(i)}),(function(i){s(i)}))}))}},{key:"ver_sucursal",value:function(i){return this.http.get(this.apiDir+"/sucursales/id/"+i,this.requestOptions)}},{key:"crear_pdf",value:function(i){return this.http.post(this.apiDir+"/pdf/create-pdf",i,this.requestOptions)}},{key:"ver_pdf",value:function(i){return this.http.get(this.apiDir+"/pdf/fetch-pdf/"+i,this.requestOptions)}},{key:"modificar_cliente",value:function(i){return this.http.post(this.apiDir+"/clientes/actualizar",i,this.requestOptions)}},{key:"subir_logo_cliente",value:function(i){return this.http.post(this.apiDir+"/clientes/actualizarLogo",i,this.requestOptions)}},{key:"eliminar_Logo_Cliente",value:function(i){return this.http.post(this.apiDir+"/clientes/eliminarLogo",i,this.requestOptions)}},{key:"eliminar_cliente",value:function(i){return this.http.post(this.apiDir+"/clientes/eliminar/"+i,this.requestOptions)}},{key:"eliminar_sucursal",value:function(i){return this.http.post(this.apiDir+"/sucursales/eliminar/"+i,this.requestOptions)}},{key:"eliminar_plano",value:function(i){return this.http.post(this.apiDir+"/planos/eliminar/"+i,this.requestOptions)}},{key:"modificar_sucursal",value:function(i){return this.http.post(this.apiDir+"/sucursales/actualizar",i,this.requestOptions)}}]),i}();return i.\u0275fac=function(e){return new(e||i)(n.Sb(s.a))},i.\u0275prov=n.Fb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}()},lENo:function(i,e,t){"use strict";t.d(e,"a",(function(){return W}));var o=t("mrSG"),s=t("fXoL"),r=t("TEn/"),n=t("+1S5"),a=t("89nv"),c=t("ofXK"),u=t("3Pt+");function l(i,e){if(1&i&&(s.Ob(0,"ion-select-option",7),s.kc(1),s.Nb()),2&i){var t=e.$implicit;s.dc("value",t.name),s.zb(1),s.lc(t.name)}}function p(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-item"),s.Ob(2,"ion-label"),s.kc(3),s.Nb(),s.Ob(4,"ion-select",5),s.Wb("ngModelChange",(function(i){s.gc(t);var e=s.Yb().index;return s.Yb(2).respuestas[e].respuesta=i})),s.jc(5,l,2,2,"ion-select-option",6),s.Nb(),s.Nb(),s.Nb()}if(2&i){var o=s.Yb(),r=o.$implicit,n=o.index,a=s.Yb(2);s.zb(3),s.lc(r.nombreCampo),s.zb(1),s.dc("ngModel",a.respuestas[n].respuesta),s.zb(1),s.dc("ngForOf",r.opciones)}}function v(i,e){if(1&i&&(s.Ob(0,"ion-select-option",7),s.kc(1),s.Nb()),2&i){var t=e.$implicit;s.dc("value",t.name),s.zb(1),s.lc(t.name)}}function d(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-item"),s.Ob(2,"ion-label"),s.kc(3,"Otros: "),s.Nb(),s.Ob(4,"ion-input",9),s.Wb("ngModelChange",(function(i){return s.gc(t),s.Yb(4).otros=i})),s.Nb(),s.Nb(),s.Nb()}if(2&i){var o=s.Yb(4);s.zb(4),s.dc("ngModel",o.otros)}}function b(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-item"),s.Ob(2,"ion-label"),s.kc(3),s.Nb(),s.Ob(4,"ion-select",8),s.Wb("ngModelChange",(function(i){s.gc(t);var e=s.Yb().index;return s.Yb(2).respuestas[e].respuesta=i})),s.jc(5,v,2,2,"ion-select-option",6),s.Nb(),s.Nb(),s.jc(6,d,5,1,"div",1),s.Nb()}if(2&i){var o=s.Yb(),r=o.$implicit,n=o.index,a=s.Yb(2);s.zb(3),s.lc(r.nombreCampo),s.zb(1),s.dc("ngModel",a.respuestas[n].respuesta),s.zb(1),s.dc("ngForOf",r.opciones),s.zb(1),s.dc("ngIf",("multiple"==r.tipoCampo||"Multiple"==r.tipoCampo)&&30==r.id_campo&&a.mostrarOtros())}}function f(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-item"),s.Ob(2,"ion-label"),s.kc(3),s.Nb(),s.Ob(4,"ion-input",9),s.Wb("ngModelChange",(function(i){s.gc(t);var e=s.Yb().index;return s.Yb(2).respuestas[e].respuesta=i})),s.Nb(),s.Nb(),s.Nb()}if(2&i){var o=s.Yb(),r=o.$implicit,n=o.index,a=s.Yb(2);s.zb(3),s.lc(r.nombreCampo),s.zb(1),s.dc("ngModel",a.respuestas[n].respuesta)}}function h(i,e){if(1&i&&(s.Ob(0,"div"),s.jc(1,p,6,3,"div",1),s.jc(2,b,7,4,"div",1),s.jc(3,f,5,2,"div",1),s.Nb()),2&i){var t=e.$implicit;s.zb(1),s.dc("ngIf","Select"==t.tipoCampo||"select"==t.tipoCampo),s.zb(1),s.dc("ngIf","multiple"==t.tipoCampo||"Multiple"==t.tipoCampo),s.zb(1),s.dc("ngIf","input"==t.tipoCampo||"Input"==t.tipoCampo)}}function _(i,e){if(1&i&&(s.Ob(0,"div"),s.jc(1,h,4,3,"div",4),s.Nb()),2&i){var t=s.Yb();s.zb(1),s.dc("ngForOf",t.servicio.formulario)}}var m,g=((m=function(){function i(e,t,o,s){_classCallCheck(this,i),this.navParams=e,this.apiServicios=t,this.apiVisitas=o,this.modalcontroller=s}return _createClass(i,[{key:"ngOnInit",value:function(){var i=this;this.id_servicio=this.navParams.get("id_servicio"),this.id_visita=this.navParams.get("id_visita"),this.id_formulario=this.navParams.get("id_formulario"),this.navParams.get("equipo")&&(this.equipo=this.navParams.get("equipo")),console.log(this.id_formulario),this.apiVisitas.getRespuestas(this.id_formulario).then((function(e){i.respuestas=e.respuestas,console.log(i.respuestas),i.apiServicios.ver_servicio(i.id_servicio).subscribe((function(e){i.servicio=e.result;for(var t=function(e){var t=i.servicio.formulario[e];if("multiple"==t.tipoCampo.toLowerCase()&&30==t.id_campo){s=i.respuestas[e].respuesta.split(" - ")[i.respuestas[e].respuesta.split(" - ").length-1],t.opciones.find((function(i){return i.name==s}))||(i.otros=s),r=i.respuestas[e].respuesta,i.respuestas[e].respuesta=[];for(var o=0;o<r.split(" - ").length;o++){var n=r.split(" - ")[o];""!=n&&(i.respuestas[e].respuesta[o]=n)}t.opciones.find((function(t){return t.name==i.respuestas[e].respuesta[i.respuestas[e].respuesta.length-1]}))||(i.respuestas[e].respuesta[i.respuestas[e].respuesta.length-1]="Otros")}if("multiple"==t.tipoCampo.toLowerCase()&&30!=t.id_campo){r=i.respuestas[e].respuesta,i.respuestas[e].respuesta=[];for(var a=0;a<r.split(" - ").length;a++){var c=r.split(" - ")[a];""!=c&&(i.respuestas[e].respuesta[a]=c)}}},o=0;o<i.servicio.formulario.length;o++){var s,r;t(o)}console.log(i.servicio);var n=i.respuestas.findIndex((function(i){return 55==i.id_campo}));i.respuestas[n]&&(i.respuestas[n].respuesta=i.servicio.listaProductos.find((function(e){return e.id_producto==i.respuestas[n].respuesta})).tipo_producto);var a=i.respuestas.findIndex((function(i){return 70==i.id_campo}));if(i.respuestas[a]){r=i.respuestas[a];for(var c=[],u=function(e){c.push(i.servicio.listaProductos.find((function(t){return t.id_producto==i.respuestas[a].respuesta[e]})).tipo_producto)},l=0;l<i.respuestas[a].respuesta.length;l++)u(l);i.respuestas[a].respuesta=c}console.log(i.respuestas)}))})).catch((function(i){console.warn(i)}))}},{key:"modalDissmiss",value:function(){this.modalcontroller.dismiss()}},{key:"prueba1",value:function(i){console.log(i)}},{key:"prueba",value:function(){console.log(this.respuestas)}},{key:"cambio",value:function(i,e){this.respuestas[e].respuesta=i.toString()}},{key:"guardar",value:function(){var i=this;if(this.respuestas.find((function(i){return 30==i.id_campo}))){var e=this.respuestas.findIndex((function(i){return 30==i.id_campo}));this.respuestas[e].respuesta.includes("Otros")&&this.respuestas[e].respuesta.splice(this.respuestas[e].respuesta.length-1,1,this.otros)}for(var t=0;t<this.servicio.formulario.length;t++){var o,s=this.servicio.formulario[t];if("multiple"==s.tipoCampo.toLowerCase()){for(var r,n=this.respuestas[t].respuesta,a=0;a<n.length;a++){var c=n[a];console.log(c),0==a?(console.log("5"),r=c):(console.log("6"),r=r+" - "+c)}this.respuestas[t].respuesta=r}if("Tipo de producto"==s.nombreCampo){for(var u=function(e){var s=i.respuestas[t].respuesta.split(" - ")[e];console.log(s),(n=i.servicio.listaProductos.find((function(i){return i.nombre_producto.toLowerCase()==s.toLowerCase()})))||(n=i.servicio.listaProductos.find((function(i){return i.tipo_producto.toLowerCase()==s.toLowerCase()}))),o=0==e?n.id_producto.toString():o+" - "+n.id_producto.toString()},l=0;l<this.respuestas[t].respuesta.split(" - ").length;l++)u(l);this.respuestas[t].respuesta=o}}this.apiVisitas.cambiarRespuestas(this.respuestas).then((function(e){i.modalDissmiss()}))}},{key:"mostrarOtros",value:function(){return this.respuestas.find((function(i){return 30==i.id_campo})).respuesta.includes("Otros")}}]),i}()).\u0275fac=function(i){return new(i||m)(s.Jb(r.I),s.Jb(n.a),s.Jb(a.a),s.Jb(r.G))},m.\u0275cmp=s.Db({type:m,selectors:[["app-editar-visita"]],decls:15,vars:2,consts:[["color","primary",2,"text-align","center"],[4,"ngIf"],[1,"ion-text-center"],[1,"button",2,"width","50%",3,"click"],[4,"ngFor","ngForOf"],["mode","ios",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["multiple","","mode","ios",3,"ngModel","ngModelChange"],["mode","ios",2,"margin-left","10px",3,"ngModel","ngModelChange"]],template:function(i,e){1&i&&(s.Ob(0,"ion-header"),s.Ob(1,"ion-toolbar",0),s.Ob(2,"ion-title"),s.kc(3),s.Nb(),s.Nb(),s.Nb(),s.Ob(4,"ion-content"),s.jc(5,_,2,1,"div",1),s.Ob(6,"ion-row"),s.Ob(7,"ion-col",2),s.Ob(8,"div"),s.Ob(9,"ion-button",3),s.Wb("click",(function(){return e.modalDissmiss()})),s.kc(10,"Volver"),s.Nb(),s.Nb(),s.Nb(),s.Ob(11,"ion-col",2),s.Ob(12,"div"),s.Ob(13,"ion-button",3),s.Wb("click",(function(){return e.guardar()})),s.kc(14,"Guardar"),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&i&&(s.zb(3),s.lc(e.equipo?e.equipo:null==e.servicio?null:e.servicio.nombreDelServicio),s.zb(2),s.dc("ngIf",e.servicio))},directives:[r.o,r.D,r.C,r.i,c.j,r.u,r.h,r.d,c.i,r.r,r.s,r.w,r.M,u.d,u.e,r.x,r.q,r.N],styles:[""]}),m);function O(i,e){if(1&i){var t=s.Pb();s.Ob(0,"ion-item",4),s.Wb("click",(function(){s.gc(t);var i=e.$implicit;return s.Yb().editarServicio(i.id_formulario,i.nombre_equipo)})),s.Ob(1,"ion-label"),s.kc(2),s.Nb(),s.Nb()}if(2&i){var o=e.$implicit;s.zb(2),s.lc(o.nombre_equipo)}}var k,y=((k=function(){function i(e,t,o,s){_classCallCheck(this,i),this.navParams=e,this.apiServicios=t,this.apiVisitas=o,this.modalController=s}return _createClass(i,[{key:"ngOnInit",value:function(){var i=this;this.id_servicio=this.navParams.get("id_servicio");var e=[];new Promise((function(t,o){for(var s=function(o){var s=i.navParams.get("visita").servicios[o];20!=s.id_servicio&&22!=s.id_servicio||s.id_servicio!=i.id_servicio||(i.apiVisitas.getRespuestas(s.id_formulario).then((function(e){s.respuestas=e.respuestas,i.apiVisitas.getEquipo(s.respuestas[0].id_equipo).then((function(i){i.result[0]&&(s.nombre_equipo=i.result[0].nombre_equipo)}))})).catch((function(i){console.error(i)})),e.push(s)),o==i.navParams.get("visita").servicios.length-1&&t("")},r=0;r<i.navParams.get("visita").servicios.length;r++)s(r)})).then((function(){i.servicios=e,console.log(i.servicios)})).catch((function(i){console.error(i)}))}},{key:"ngOnDestroy",value:function(){}},{key:"editarServicio",value:function(i,e){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:g,componentProps:{id_servicio:this.id_servicio,id_visita:this.navParams.get("visita").id_visita,id_formulario:i,equipo:e}});case 2:return o=t.sent,t.next=5,o.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"modalDismiss",value:function(){this.modalController.dismiss()}}]),i}()).\u0275fac=function(i){return new(i||k)(s.Jb(r.I),s.Jb(n.a),s.Jb(a.a),s.Jb(r.G))},k.\u0275cmp=s.Db({type:k,selectors:[["app-ver-servicio-visita"]],decls:11,vars:2,consts:[["color","primary"],[3,"click",4,"ngFor","ngForOf"],[1,"ion-text-center"],[1,"button",2,"width","50%",3,"click"],[3,"click"]],template:function(i,e){1&i&&(s.Ob(0,"ion-header"),s.Ob(1,"ion-toolbar",0),s.Ob(2,"ion-title"),s.kc(3),s.Nb(),s.Nb(),s.Nb(),s.Ob(4,"ion-content"),s.jc(5,O,3,1,"ion-item",1),s.Ob(6,"ion-row"),s.Ob(7,"ion-col",2),s.Ob(8,"div"),s.Ob(9,"ion-button",3),s.Wb("click",(function(){return e.modalDismiss()})),s.kc(10,"Volver"),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&i&&(s.zb(3),s.lc(e.servicios?e.servicios[0].nombre_servicio:null),s.zb(2),s.dc("ngForOf",e.servicios))},directives:[r.o,r.D,r.C,r.i,c.i,r.u,r.h,r.d,r.r,r.s],styles:[""]}),k),q=t("OAWW"),N=t("jCJ1");function C(i,e){1&i&&(s.Ob(0,"div",7),s.Kb(1,"ion-spinner"),s.Nb())}function D(i,e){if(1&i&&(s.Ob(0,"div"),s.Ob(1,"ion-item",8),s.Ob(2,"ion-label"),s.Ob(3,"b"),s.kc(4,"Fecha de concluida la visita:"),s.Nb(),s.kc(5),s.Zb(6,"date"),s.Nb(),s.Nb(),s.Nb()),2&i){var t=s.Yb(2);s.zb(5),s.mc(" ",s.ac(6,1,t.visita.visitas.horario_salida,"dd/MM/yyyy hh:mm"),"")}}function w(i,e){if(1&i&&(s.Ob(0,"div"),s.Ob(1,"ion-item"),s.Ob(2,"ion-label"),s.Ob(3,"b"),s.kc(4,"Fecha estimada de la visita:"),s.Nb(),s.kc(5),s.Zb(6,"date"),s.Nb(),s.Nb(),s.Nb()),2&i){var t=s.Yb(2);s.zb(5),s.mc(" ",s.ac(6,1,t.visita.visitas.fecha_visita,"dd/MM/yyyy hh:mm"),"")}}function z(i,e){if(1&i){var t=s.Pb();s.Ob(0,"ion-icon",13),s.Wb("click",(function(){s.gc(t);var i=s.Yb().$implicit;return s.Yb(2).editarServicio(i.id_servicio,i.id_formulario)})),s.Nb()}}function x(i,e){if(1&i&&(s.Ob(0,"div",10),s.Kb(1,"ion-icon",11),s.kc(2),s.jc(3,z,1,0,"ion-icon",12),s.Nb()),2&i){var t=e.$implicit,o=s.Yb(2);s.zb(2),s.mc(" ",t.nombre_servicio," "),s.zb(1),s.dc("ngIf","finalizada"==o.visita.visitas.estado_visitas)}}function P(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-button",14),s.Wb("click",(function(){return s.gc(t),s.Yb(3).generar_pdf()})),s.kc(2,"Generar PDF"),s.Nb(),s.Nb()}}function j(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-button",15),s.Wb("click",(function(){return s.gc(t),s.Yb(3).ver_pdf()})),s.kc(2,"Ver PDF"),s.Nb(),s.Nb()}}function I(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-button",14),s.Wb("click",(function(){return s.gc(t),s.Yb(3).generar_pdf()})),s.kc(2,"Volver a generar PDF"),s.Nb(),s.Nb()}}function M(i,e){if(1&i&&(s.Ob(0,"div"),s.jc(1,P,3,0,"div",5),s.jc(2,j,3,0,"div",5),s.jc(3,I,3,0,"div",5),s.Nb()),2&i){var t=s.Yb(2);s.zb(1),s.dc("ngIf",!t.pdf_generado&&0==t.visita.visitas.pdfGenerado),s.zb(1),s.dc("ngIf",t.pdf_generado||1==t.visita.visitas.pdfGenerado),s.zb(1),s.dc("ngIf",t.pdf_generado||1==t.visita.visitas.pdfGenerado)}}function S(i,e){if(1&i){var t=s.Pb();s.Ob(0,"div"),s.Ob(1,"ion-button",14),s.Wb("click",(function(){return s.gc(t),s.Yb(2).modificar_visita()})),s.kc(2,"Modificar visita"),s.Nb(),s.Nb()}}function F(i,e){if(1&i&&(s.Ob(0,"div"),s.jc(1,D,7,4,"div",5),s.jc(2,w,7,4,"div",5),s.Ob(3,"ion-item",8),s.Ob(4,"ion-label"),s.Ob(5,"b"),s.kc(6,"Cliente:"),s.Nb(),s.kc(7),s.Nb(),s.Nb(),s.Ob(8,"ion-item",8),s.Ob(9,"ion-label"),s.Ob(10,"b"),s.kc(11,"Sucursal:"),s.Nb(),s.kc(12),s.Nb(),s.Nb(),s.Ob(13,"ion-item",8),s.Ob(14,"ion-label"),s.Ob(15,"b"),s.kc(16,"Servicios ofrecidos:"),s.Nb(),s.jc(17,x,4,2,"div",9),s.Nb(),s.Nb(),s.jc(18,M,4,3,"div",5),s.jc(19,S,3,0,"div",5),s.Nb()),2&i){var t=s.Yb();s.zb(1),s.dc("ngIf","NULL"!=t.visita.visitas.horario_salida),s.zb(1),s.dc("ngIf","NULL"==t.visita.visitas.horario_salida),s.zb(5),s.mc(" ",t.visita.visitas.razon_social_cliente,""),s.zb(5),s.mc(" ",t.visita.visitas.razon_social_sucursal,""),s.zb(5),s.dc("ngForOf",t.visita.servicios2),s.zb(1),s.dc("ngIf","NULL"!=t.visita.visitas.horario_salida),s.zb(1),s.dc("ngIf","NULL"==t.visita.visitas.horario_salida)}}var E,W=((E=function(){function i(e,t,o,s){_classCallCheck(this,i),this.navParams=e,this.api_visitas=t,this.modalController=o,this.loadingController=s,this.id_visita=this.navParams.get("id_visita"),this.pdf_generado=!1}return _createClass(i,[{key:"ngOnInit",value:function(){this.actualizar_informacion()}},{key:"generar_pdf",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var e,t=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.loadingController.create({message:"Generando PDF"});case 2:(e=i.sent).present(),console.log(this.id_visita),this.api_visitas.crear_pdf({id_visita:this.id_visita}).subscribe((function(i){console.log(i),t.pdf_generado=!0,e.dismiss()}),(function(i){console.log(i),e.dismiss()}));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"ver_pdf",value:function(){var i=this;this.api_visitas.ver_pdf(this.id_visita).subscribe((function(e){i.url=e,console.log(i.url.url),window.open(i.url.url,"_blank").focus()}),(function(i){console.log(i)}))}},{key:"close",value:function(){this.modalController.dismiss()}},{key:"actualizar_informacion",value:function(){var i=this;this.api_visitas.informacion_visita(this.id_visita).then((function(e){var t;if(i.visita=e,i.visita=i.visita.result,console.log(i.visita),i.visita){i.visita.servicios2=[];var o,s=_createForOfIteratorHelper(i.visita.servicios);try{var r=function(){var e=o.value;(null===(t=i.visita)||void 0===t?void 0:t.servicios2.find((function(i){return i.nombre_servicio==e.nombre_servicio})))||i.visita.servicios2.push(22==e.id_servicio||20==e.id_servicio?{nombre_servicio:e.nombre_servicio,id_servicio:e.id_servicio,id_formulario:null}:e)};for(s.s();!(o=s.n()).done;)r()}catch(n){s.e(n)}finally{s.f()}}}))}},{key:"modificar_visita",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var e,t=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.modalController.create({component:q.a,cssClass:"my-custom-class",componentProps:{id_visita:this.id_visita}});case 2:return(e=i.sent).onDidDismiss().then((function(i){t.actualizar_informacion()})),i.next=6,e.present();case 6:return i.abrupt("return",i.sent);case 7:case"end":return i.stop()}}),i,this)})))}},{key:"editarServicio",value:function(i,e){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=8;break}return t.next=3,this.modalController.create({component:g,componentProps:{id_servicio:i,id_visita:this.id_visita,id_formulario:e}});case 3:return o=t.sent,t.next=6,o.present();case 6:t.next=13;break;case 8:return t.next=10,this.modalController.create({component:y,componentProps:{id_servicio:i,visita:this.visita}});case 10:return s=t.sent,t.next=13,s.present();case 13:case"end":return t.stop()}}),t,this)})))}}]),i}()).\u0275fac=function(i){return new(i||E)(s.Jb(r.I),s.Jb(N.a),s.Jb(r.G),s.Jb(r.F))},E.\u0275cmp=s.Db({type:E,selectors:[["app-ver-visita"]],decls:12,vars:2,consts:[["color","primary",2,"text-align","center"],["slot","end"],[3,"click"],["name","close-outline"],["style","text-align: center;",4,"ngIf"],[4,"ngIf"],["src","../../../assets/LogoCPA-01.png",1,"imagen_empresa"],[2,"text-align","center"],["lines","full"],["style","margin-left:10px; margin-top: 10px",4,"ngFor","ngForOf"],[2,"margin-left","10px","margin-top","10px"],["name","document-outline","color","primary"],["name","create-outline","style","cursor: pointer;",3,"click",4,"ngIf"],["name","create-outline",2,"cursor","pointer",3,"click"],["expand","full",3,"click"],["expand","full","color","success",3,"click"]],template:function(i,e){1&i&&(s.Ob(0,"ion-header"),s.Ob(1,"ion-toolbar",0),s.Ob(2,"ion-title"),s.kc(3,"visita"),s.Nb(),s.Ob(4,"ion-buttons",1),s.Ob(5,"ion-button",2),s.Wb("click",(function(){return e.close()})),s.Kb(6,"ion-icon",3),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Ob(7,"ion-content"),s.jc(8,C,2,0,"div",4),s.jc(9,F,20,7,"div",5),s.Ob(10,"div"),s.Kb(11,"img",6),s.Nb(),s.Nb()),2&i&&(s.zb(8),s.dc("ngIf",!e.visita),s.zb(1),s.dc("ngIf",e.visita))},directives:[r.o,r.D,r.C,r.e,r.d,r.p,r.i,c.j,r.y,r.r,r.s,c.i],pipes:[c.d],styles:[""]}),E)}}]);